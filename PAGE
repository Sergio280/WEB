<!DOCTYPE html>
<html>
<head>
    <title>Firebase Setup</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body>
    <h1>Firebase User Setup</h1>
    <button onclick="createUsersAndLicenses()">Crear Usuarios y Licencias</button>
    <div id="results"></div>

    <script>
        // TU CONFIGURACIÓN DE FIREBASE (Imagen 1)
        const firebaseConfig = {
            apiKey: "TU_API_KEY_AQUI",
            authDomain: "bims-8d507.firebaseapp.com",
            databaseURL: "https://bims-8d507-default-rtdb.firebaseio.com",
            projectId: "bims-8d507",
            storageBucket: "bims-8d507.appspot.com",
            messagingSenderId: "TU_SENDER_ID",
            appId: "TU_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);

        const users = [
            { email: "admin@empresa.com", password: "Admin123!Secure", role: "Admin", licenseType: "enterprise", maxDevices: 3 },
            { email: "user1@empresa.com", password: "User123!Secure", role: "User", licenseType: "pro", maxDevices: 2 },
            { email: "user2@empresa.com", password: "User456!Secure", role: "User", licenseType: "trial", maxDevices: 1 }
        ];

        async function createUsersAndLicenses() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Creando usuarios...</p>';

            for (const user of users) {
                try {
                    // Crear usuario en Authentication
                    const userCredential = await firebase.auth().createUserWithEmailAndPassword(
                        user.email, 
                        user.password
                    );
                    
                    const uid = userCredential.user.uid;

                    // Crear licencia en Realtime Database
                    await firebase.database().ref('licenses/' + uid).set({
                        email: user.email,
                        active: true,
                        role: user.role,
                        licenseType: user.licenseType,
                        expirationDate: "2025-12-31",
                        maxDevices: user.maxDevices,
                        devices: {},
                        createdAt: new Date().toISOString(),
                        lastLogin: null
                    });

                    results.innerHTML += `<p>✅ Usuario creado: ${user.email} (UID: ${uid})</p>`;
                    
                    // Cerrar sesión para crear el siguiente usuario
                    await firebase.auth().signOut();
                    
                } catch (error) {
                    results.innerHTML += `<p>❌ Error con ${user.email}: ${error.message}</p>`;
                }
            }
            
            results.innerHTML += '<p><strong>✅ PROCESO COMPLETADO</strong></p>';
        }
    </script>
</body>
</html>
